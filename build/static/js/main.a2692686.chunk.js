(this.webpackJsonpchatchan=this.webpackJsonpchatchan||[]).push([[0],{1023:function(e,t){},1025:function(e,t){},1035:function(e,t){},1037:function(e,t){},1064:function(e,t){},1065:function(e,t){},1070:function(e,t){},1072:function(e,t){},1079:function(e,t){},1098:function(e,t){},1431:function(e,t,a){"use strict";a.r(t);var n,r,s,c,i,o,l,u,p,h,m,f,b,d,v,_,g,O,j,y,k,E,x,w,N,C,S=a(0),I=a.n(S),q=a(34),A=a.n(q),P=(a(577),a(9)),T=a(12),K=a(15),z=a(16),D=a(29),F=a(48),M=a(6),R=Object(M.b)("store")(n=Object(M.c)(n=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){return I.a.createElement("div",{className:"title"},I.a.createElement("h1",null,"Hello\uff0c",this.props.store.appname))}}]),a}(S.Component))||n)||n,W=a(1468),L=(r=Object(M.b)("store"),Object(F.f)(s=r(s=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){var e=this;return I.a.createElement("div",null,I.a.createElement("h1",null,I.a.createElement(R,null)),I.a.createElement("div",null,I.a.createElement(W.b,{onClick:function(){return e.props.store.appname+="\ud83c\udf88"}},"change")),I.a.createElement("div",null,I.a.createElement("span",{onClick:function(){return e.props.history.push("/login")}},"Login")))}}]),a}(S.Component))||s)||s),B=a(437),Y=a.n(B),H=(c=Object(M.b)("store"),Object(F.f)(i=c(i=Object(M.c)(i=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){var e=this.props.data;return e?I.a.createElement("div",{className:"user-span"},I.a.createElement("img",{src:e.avatar_url,className:"avatar"}),e.name,e.coin>=0&&I.a.createElement("span",{className:"coin bg-blue-500 text-white font-mono text-xs"},e.coin)):null}}]),a}(S.Component))||i)||i),a(53)),J=a(50),U=a(1467),G=a(3),V=a.n(G),$=a(10),Z=a(49),Q=a(43),X=(a(606),a(14)),ee=a(210),te=a.n(ee),ae=function(){function e(t){Object(P.a)(this,e),this.store=t}return Object(T.a)(e,[{key:"get",value:function(){var e=Object($.a)(V.a.mark((function e(t){var a,n,r=arguments;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]?r[1]:null,n=null==a?this.store.apibase+t:this.store.apibase+t+ds+new URLSearchParams(a).toString(),e.abrupt("return",this.rawGet(n));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rawGet",value:function(){var e=Object($.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,te.a.get(t);case 3:return e.t1=e.sent,e.abrupt("return",e.t0.return_data.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object($.a)(V.a.mark((function e(t){var a,n,r,s,c=arguments;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:null,n=!(c.length>2&&void 0!==c[2])||c[2],r=!(c.length>3&&void 0!==c[3])||c[3],s=this.store.apibase+t,e.abrupt("return",this.rawPost(s,a,n,r));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rawPost",value:function(){var e=Object($.a)(V.a.mark((function e(t){var a,n,r,s,c=arguments;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:null,n=!(c.length>2&&void 0!==c[2])||c[2],r=!(c.length>3&&void 0!==c[3])||c[3],e.prev=3,s=new URLSearchParams,a&&Object.keys(a).forEach((function(e){return s.append(e,a[e])})),n&&this.store.token&&s.append("token",this.store.token),e.t0=this,e.next=10,te.a.post(t,s);case 10:return e.t1=e.sent,e.t2=r,e.abrupt("return",e.t0.return_data.call(e.t0,e.t1,e.t2));case 15:return e.prev=15,e.t3=e.catch(3),console.log(e.t3),e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e,this,[[3,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"upload",value:function(){var e=Object($.a)(V.a.mark((function e(t){var a,n,r,s,c=arguments;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:null,n=!(c.length>2&&void 0!==c[2])||c[2],r=!(c.length>3&&void 0!==c[3])||c[3],s=new FormData,a&&Object.keys(a).forEach((function(e){return s.append(e,a[e])})),n&&this.store.token&&s.append("token",this.store.token),e.t0=this,e.next=9,te.a.post(this.store.apibase+t,s);case 9:return e.t1=e.sent,e.t2=r,e.next=13,e.t0.return_data.call(e.t0,e.t1,e.t2);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"return_data",value:function(){var e=Object($.a)(V.a.mark((function e(t){var a=arguments;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.length>1&&void 0!==a[1])||a[1],200!=parseInt(t.status)){e.next=8;break}if(!t.data){e.next=5;break}return 80403==t.data.code&&(ce("\u8bf7\u767b\u5165\u540e\u7ee7\u7eed"),window.location="/login"),e.abrupt("return",t.data);case 5:return e.abrupt("return",!1);case 8:console.log(t);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ne=new(o=function(){function e(){Object(P.a)(this,e),Object(Z.a)(this,"appname",l,this),Object(Z.a)(this,"apibase",u,this),Object(Z.a)(this,"local_apibase",p,this),Object(Z.a)(this,"session",h,this),Object(Z.a)(this,"token",m,this),Object(Z.a)(this,"user",f,this),this.ftopenapp_id="26",this.to_save_vars=["user","token","_chat_saved_list","_chat_model","_chat_key","_chat_api_url","_chat_avatar_url","_chat_max_tokens","_chat_temperature"],Object(Z.a)(this,"menu",b,this),Object(Z.a)(this,"coin_name",d,this),Object(Z.a)(this,"recharge_input_coin",v,this),Object(Z.a)(this,"_donate_keys",_,this),Object(Z.a)(this,"_donate_title",g,this),Object(Z.a)(this,"_donate_link",O,this),Object(Z.a)(this,"_chat_model",j,this),Object(Z.a)(this,"_chat_saved_list",y,this),Object(Z.a)(this,"_chat_key",k,this),Object(Z.a)(this,"_chat_api_url",E,this),Object(Z.a)(this,"_chat_avatar_url",x,this),Object(Z.a)(this,"_chat_max_tokens",w,this),Object(Z.a)(this,"_chat_temperature",N,this),Object(Z.a)(this,"_chat_timeout",C,this),this.api=new ae(this),this.load_vars()}return Object(T.a)(e,[{key:"load_vars",value:function(){var e=this;this.to_save_vars.forEach((function(t){var a=window.localStorage.getItem("FT_CHATCHAN_VAR_"+t);a&&(e[t]=JSON.parse(a))}))}},{key:"save_vars",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=null===t?this.to_save_vars:[t];a.forEach((function(t){window.localStorage.setItem("FT_CHATCHAN_VAR_"+t,JSON.stringify(e[t]))}))}},{key:"get_wechat_login_url",value:function(){var e=Object($.a)(V.a.mark((function e(){var t,a,n,r=arguments;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:this.ftopenapp_id,a=r.length>1&&void 0!==r[1]?r[1]:this.session,e.next=4,this.api.get("global/user/get_wx_sns_login_url?id="+t+"&session="+a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"get_token_by_code",value:function(){var e=Object($.a)(V.a.mark((function e(t){var a,n,r=arguments;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]?r[1]:"",e.next=3,this.api.post("global/user/get_token_by_wx_code",{code:t,session:a});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"preorder",value:function(){var e=Object($.a)(V.a.mark((function e(t){var a;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("global/pay/order",{amount_cent:t});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"logout",value:function(){this.user=null,this.token=null,window.localStorage.clear()}},{key:"set_user",value:function(e){this.user=e,this.token=e.session_id,this.save_vars()}},{key:"check_user_info",value:function(){var e=Object($.a)(V.a.mark((function e(){var t,a,n,r=arguments;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=r.length>0&&void 0!==r[0]?r[0]:null)){e.next=8;break}return e.next=4,this.api.post("global/user/get_user_session",{token:t},!1);case 4:return a=e.sent,e.abrupt("return",a);case 8:return e.next=10,this.api.post("global/user/get_user_session");case 10:return n=e.sent,e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"get_user_profile",value:function(){var e=Object($.a)(V.a.mark((function e(){var t;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("global/user/profile");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),l=Object(Q.a)(o.prototype,"appname",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Chat\u9171"}}),u=Object(Q.a)(o.prototype,"apibase",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"https://openapi.ftqq.com/"}}),p=Object(Q.a)(o.prototype,"local_apibase",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),h=Object(Q.a)(o.prototype,"session",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),m=Object(Q.a)(o.prototype,"token",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),f=Object(Q.a)(o.prototype,"user",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),b=Object(Q.a)(o.prototype,"menu",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[{id:8001,text:"\u9996\u9875",link:"/home",member_only:!1}]}}),Object(Q.a)(o.prototype,"logout",[X.f],Object.getOwnPropertyDescriptor(o.prototype,"logout"),o.prototype),Object(Q.a)(o.prototype,"set_user",[X.f],Object.getOwnPropertyDescriptor(o.prototype,"set_user"),o.prototype),d=Object(Q.a)(o.prototype,"coin_name",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"\u91d1\u5e01"}}),v=Object(Q.a)(o.prototype,"recharge_input_coin",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),_=Object(Q.a)(o.prototype,"_donate_keys",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),g=Object(Q.a)(o.prototype,"_donate_title",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),O=Object(Q.a)(o.prototype,"_donate_link",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),j=Object(Q.a)(o.prototype,"_chat_model",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"gpt-3.5-turbo"}}),y=Object(Q.a)(o.prototype,"_chat_saved_list",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k=Object(Q.a)(o.prototype,"_chat_key",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),E=Object(Q.a)(o.prototype,"_chat_api_url",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"https://api.openai.com"}}),x=Object(Q.a)(o.prototype,"_chat_avatar_url",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),w=Object(Q.a)(o.prototype,"_chat_max_tokens",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e3}}),N=Object(Q.a)(o.prototype,"_chat_temperature",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),C=Object(Q.a)(o.prototype,"_chat_timeout",[X.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 60}}),o),re=W.n.create({className:"lm-toaster",position:J.a.TOP});a(624),a(625);function se(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)}function ce(e){re.show({message:e})}var ie,oe,le,ue,pe,he,me,fe,be,de,ve,_e,ge,Oe,je,ye,ke,Ee,xe,we,Ne,Ce,Se,Ie,qe,Ae,Pe,Te,Ke,ze,De,Fe,Me,Re,We,Le,Be,Ye,He,Je,Ue,Ge,Ve,$e=a(11),Ze=a(438),Qe=a.n(Ze),Xe=Object(F.f)(ie=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){var e;Object(P.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={value:e.props.value,img_url:""},e}return Object(T.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.ck=setInterval((function(){return e.check()}),500)}},{key:"componentWillUnmount",value:function(){this.ck&&clearInterval(this.ck)}},{key:"check",value:function(){var e=document.getElementById("theqr__inbox");e&&(this.setState({img_url:e.toDataURL("image/png")}),clearInterval(this.ck))}},{key:"render",value:function(){return I.a.createElement("div",{className:this.props.className},this.state.img_url.length>0?I.a.createElement("img",{style:{maxWidth:200},src:this.state.img_url}):I.a.createElement(Qe.a,Object($e.a)({size:200,value:this.state.value,includeMargin:!0,id:"theqr__inbox"},"includeMargin",!0)))}}]),a}(S.Component))||ie,et=a(439),tt=a.n(et),at=(oe=Object(M.b)("store"),Object(F.f)(le=oe(le=Object(M.c)(le=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){var e;Object(P.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={qrcode_url:!1},e}return Object(T.a)(a,[{key:"go",value:function(){var e=Object($.a)(V.a.mark((function e(){var t;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.store.session=tt()({length:32}),e.next=3,this.props.store.get_wechat_login_url();case 3:(t=e.sent)&&t.url&&(se()?window.location=t.url:(this.setState({qrcode_url:t.url}),console.log(t.url)));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"check",value:function(){var e=Object($.a)(V.a.mark((function e(){var t,a;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.store.session,e.next=3,this.props.store.check_user_info(t);case 3:(a=e.sent)&&a.code>0?ce("\u8bf7\u626b\u7801\u540e\u518d\u70b9\u51fb\u6b64\u6309\u94ae"):a&&a.user&&(this.props.store.set_user(a.user),this.setState({qrcode_url:!1}),se()?this.props.history.push("/after/login"):this.props.history.push("/home"));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props,a=(t.staticContext,t.onClick,Object(H.a)(t,["staticContext","onClick"]));return I.a.createElement(I.a.Fragment,null,I.a.createElement(W.b,Object.assign({id:"wechat-login-btn",text:"\u5fae\u4fe1\u767b\u5165",onClick:function(){return e.go()}},a)),this.state.qrcode_url&&I.a.createElement(W.k,{isOpen:this.state.qrcode_url,canOutsideClickClose:!1,onClose:function(){return e.setState({qrcode_url:!1})}},I.a.createElement("div",{className:"center-box bg-white p-10 rounded"},I.a.createElement(Xe,{value:this.state.qrcode_url}),I.a.createElement("div",{className:"mt-2"},I.a.createElement(W.b,{large:!0,onClick:function(){return e.check()}},"\u5fae\u4fe1\u626b\u7801\u540e\u70b9\u6b64\u7ee7\u7eed")))))}}]),a}(S.Component))||le)||le)||le),nt=(ue=Object(M.b)("store"),Object(F.f)(pe=ue(pe=Object(M.c)(pe=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){var e=this,t=I.a.createElement(W.h,{className:"border"},I.a.createElement(W.j,{icon:"person",text:"\u6211\u7684",onClick:function(){return e.props.history.push("/profile")}}),I.a.createElement(W.j,{icon:"dollar",text:"\u5145\u503c",onClick:function(){return e.props.history.push("/recharge")}}),I.a.createElement(W.i,null),I.a.createElement(W.j,{icon:"log-out",text:"\u9000\u51fa",onClick:function(){return e.props.history.push("/logout")}})),a=this.props,n=(a.staticContext,Object(H.a)(a,["staticContext"]));return I.a.createElement("div",n,this.props.store.user?I.a.createElement(U.a,{autoFocus:!1,content:t,position:J.a.BOTTOM_RIGHT},I.a.createElement(W.b,{rightIcon:"caret-down",minimal:!0})):I.a.createElement(at,{minimal:!0}))}}]),a}(S.Component))||pe)||pe),he=Object(M.b)("store"),Object(F.f)(me=he(me=Object(M.c)(me=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=(t.staticContext,Object(H.a)(t,["staticContext"]));return I.a.createElement("div",a,I.a.createElement("div",{className:"flex flex-row items-center"},this.props.store.menu&&I.a.createElement(I.a.Fragment,null," ",I.a.createElement("svg",{className:"w-3 h-3 mr-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},I.a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"}))," "),this.props.store.menu&&this.props.store.menu.map((function(t){var a,n=!0;(t.member_only&&(e.props.store.token||(n=!1)),t.admin_only)&&((null===(a=e.props.store.user)||void 0===a?void 0:a.level)<9&&(n=!1));return n?I.a.createElement(D.c,{className:"nav-menu text-black text-lg hover:text-gray-500 hover:no-underline ",key:t.id,to:t.link},t.text):null}))))}}]),a}(S.Component))||me)||me)||me),rt=(fe=Object(M.b)("store"),Object(F.f)(be=fe(be=Object(M.c)(be=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){this.props.store.user;return I.a.createElement("div",{className:(this.props.className||"")+" header"},I.a.createElement("div",{className:"container mx-auto"},I.a.createElement("div",{className:"left flex flex-row items-center"},I.a.createElement(D.b,{to:"/"},this.props.store.appname),I.a.createElement(nt,{className:"ml-5 hidden md:block"})),I.a.createElement("div",{className:"right"})))}}]),a}(S.Component))||be)||be),de=Object(M.b)("store"),Object(F.f)(ve=de(ve=Object(M.c)(ve=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){return I.a.createElement("div",{className:(this.props.className||"")+" footer"},"\u65b9\u7cd6\u6c14\u7403 \ud83c\udf88 ftqq.com")}}]),a}(S.Component))||ve)||ve),_e=Object(M.b)("store"),Object(F.f)(ge=_e(ge=Object(M.c)(ge=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){return I.a.createElement(Y.a,{title:this.props.title||this.props.store.appname},I.a.createElement("div",{className:""},I.a.createElement("div",{className:"body container mx-auto"},this.props.main)))}}]),a}(S.Component))||ge)||ge)||ge),st=(Oe=Object(M.b)("store"),Object(F.f)(je=Oe(je=Object(M.c)(je=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){var e=I.a.createElement("div",{className:"p-32 "},"FrontPage");return I.a.createElement(rt,{title:this.props.store.appname,main:e})}}]),a}(S.Component))||je)||je),ye=Object(M.b)("store"),Object(F.f)(ke=ye(ke=Object(M.c)(ke=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"componentDidMount",value:function(){var e=Object($.a)(V.a.mark((function e(){var t,a,n,r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new URLSearchParams(this.props.location.search),a=t.get("code"),n=t.get("session"),e.next=5,this.props.store.get_token_by_code(a,n);case 5:(null===(r=e.sent)||void 0===r?void 0:r.token)&&this.props.store.set_user(r.user),se()?this.props.history.push("/after/login"):this.props.history.push("/home");case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return I.a.createElement("div",{className:"flex flex-row pt-20 items-center justify-center"},I.a.createElement(W.l,null))}}]),a}(S.Component))||ke)||ke)||ke),ct=(Ee=Object(M.b)("store"),Object(F.f)(xe=Ee(xe=Object(M.c)(xe=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){var e=this,t=this.props.store[this.props.field]||"";return I.a.createElement(W.f,{label:this.props.label},"textarea"==this.props.type?I.a.createElement(W.m,{fill:this.props.fill||!1,growVertically:!0,large:!0,placeholder:this.props.placeholder,onChange:function(t){return e.props.store[e.props.field]=t.target.value},value:t,className:"fluid"}):I.a.createElement(W.g,{type:this.props.type,large:"true",placeholder:this.props.placeholder,onChange:function(t){return e.props.store[e.props.field]=t.target.value},rightElement:this.props.rightElement||null,value:t}),parseInt(this.props.max_count)>0&&I.a.createElement("div",{className:"text-count"},t.length,"/",this.props.max_count))}}]),a}(S.Component))||xe)||xe)||xe),it=(we=Object(M.b)("store"),Object(F.f)(Ne=we(Ne=Object(M.c)(Ne=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){var e;Object(P.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={qrcode_url:!1},e}return Object(T.a)(a,[{key:"go",value:function(){if(se())this.props.onClick&&this.props.onClick();else{var e=window.location.origin+"/login/auto/"+this.props.store.token+"?redirect="+encodeURIComponent(window.location.pathname+"?amount="+this.props.amount||100);this.setState({qrcode_url:e})}}},{key:"render",value:function(){var e=this,t=this.props,a=(t.staticContext,t.onClick,Object(H.a)(t,["staticContext","onClick"]));return I.a.createElement(I.a.Fragment,null,I.a.createElement(W.b,Object.assign({onClick:function(){return e.go()}},a)),this.state.qrcode_url&&I.a.createElement(W.k,{isOpen:this.state.qrcode_url,onClose:function(){return e.setState({qrcode_url:!1})}},I.a.createElement("div",{className:"center-box bg-white p-10 rounded"},I.a.createElement(Xe,{value:this.state.qrcode_url}),I.a.createElement("div",{className:"mt-2"},"\u8bf7\u7528\u5fae\u4fe1\u626b\u7801\u652f\u4ed8"))))}}]),a}(S.Component))||Ne)||Ne)||Ne),ot=(Ce=Object(M.b)("store"),Object(F.f)(Se=Ce(Se=Object(M.c)(Se=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){var e;Object(P.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={jsinfo:!1},e}return Object(T.a)(a,[{key:"componentDidMount",value:function(){var e=parseInt(new URLSearchParams(this.props.location.search).get("amount"));function t(){}this.props.store.recharge_input_coin||(this.props.store.recharge_input_coin=e),"undefined"==typeof WeixinJSBridge&&(document.addEventListener?document.addEventListener("WeixinJSBridgeReady",t,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",t),document.attachEvent("onWeixinJSBridgeReady",t)))}},{key:"launch",value:function(){var e=this;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:this.state.jsinfo.appId,timeStamp:this.state.jsinfo.timestamp,nonceStr:this.state.jsinfo.nonceStr,package:this.state.jsinfo.package,signType:this.state.jsinfo.signType,paySign:this.state.jsinfo.paySign},(function(t){"get_brand_wcpay_request:ok"==t.err_msg&&(ce("\u652f\u4ed8\u6570\u636e\u5904\u7406\u4e2d..."),e.props.history.push("/profile"))})),console.log("launch")}},{key:"recharge",value:function(){var e=Object($.a)(V.a.mark((function e(){var t,a=this;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.store.preorder(this.props.store.recharge_input_coin);case 2:(t=e.sent)&&(t.result&&(this.setState({jsinfo:t.result}),window.setTimeout((function(){return a.launch()}),600)),t.error&&ce(t.error.err_code_des));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=I.a.createElement("div",{className:"p-2 recharge-page"},I.a.createElement("div",{className:"price"},(this.props.store.recharge_input_coin/100).toFixed(2)),I.a.createElement(ct,{field:"recharge_input_coin",type:"number",placeholder:"\u8bf7\u8f93\u5165\u8981\u8d2d\u4e70\u7684"+this.props.store.coin_name+"\u6570\u91cf"}),I.a.createElement(it,{amount:this.props.store.recharge_input_coin,large:!0,onClick:function(){return e.recharge()}},"\u5145\u503c"));return I.a.createElement(rt,{title:this.props.store.appname,main:t})}}]),a}(S.Component))||Se)||Se)||Se),lt=(Ie=Object(M.b)("store"),Object(F.f)(qe=Ie(qe=Object(M.c)(qe=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"componentDidMount",value:function(){var e=Object($.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.store.logout();case 2:this.props.history.replace("/");case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=I.a.createElement("div",{className:"flex flex-row pt-20 items-center justify-center"},I.a.createElement(W.l,null));return I.a.createElement(rt,{title:this.props.store.appname,main:e})}}]),a}(S.Component))||qe)||qe)||qe),ut=(Ae=Object(M.b)("store"),Object(F.f)(Pe=Ae(Pe=Object(M.c)(Pe=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){var e;Object(P.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={user:!1},e}return Object(T.a)(a,[{key:"componentDidMount",value:function(){var e=Object($.a)(V.a.mark((function e(){var t;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.store.get_user_profile();case 2:(t=e.sent)&&t.user&&(this.setState({user:t.user}),this.props.store.set_user(t.user));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.user;if(!e)return null;var t=I.a.createElement("div",{className:"p-2 flex flex-col profile-page"},I.a.createElement("div",{className:"profile"},I.a.createElement("div",{className:"avatar"},I.a.createElement("img",{src:e.avatar_url,alt:""}),I.a.createElement("div",{className:"explain"},e.name))),I.a.createElement("div",{className:"detail"},I.a.createElement("div",{className:"row"},I.a.createElement("div",{className:"left"},"Level"),I.a.createElement("div",{className:"right"},e.level)),I.a.createElement("div",{className:"row"},I.a.createElement("div",{className:"left"},"Coin"),I.a.createElement("div",{className:"right"},e.coin))));return I.a.createElement(rt,{title:this.props.store.appname,main:t})}}]),a}(S.Component))||Pe)||Pe)||Pe),pt=(Te=Object(M.b)("store"),Object(F.f)(Ke=Te(Ke=Object(M.c)(Ke=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"componentDidMount",value:function(){document.querySelector("#wechat-login-btn").click()}},{key:"render",value:function(){var e=I.a.createElement("div",{className:"flex flex-row pt-12 items-center justify-center"},I.a.createElement(at,{large:!0}));return I.a.createElement(rt,{title:this.props.store.appname,main:e})}}]),a}(S.Component))||Ke)||Ke)||Ke),ht=(ze=Object(M.b)("store"),Object(F.f)(De=ze(De=Object(M.c)(De=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){var e=I.a.createElement("div",{className:"py-5 px-5 md:px-0 text-xl"},"\u767b\u5165\u6210\u529f\uff0c\u8bf7\u56de\u5230\u7535\u8111\u70b9\u51fb\u6309\u94ae\u7ee7\u7eed\u3002\u6216\u8005\u70b9\u51fb\u53f3\u4e0a\u89d2\u83dc\u5355\u8fdb\u884c\u64cd\u4f5c\u3002");return I.a.createElement(rt,{title:this.props.store.appname,main:e})}}]),a}(S.Component))||De)||De)||De),mt=(Fe=Object(M.b)("store"),Object(F.f)(Me=Fe(Me=Object(M.c)(Me=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"componentDidMount",value:function(){var e=Object($.a)(V.a.mark((function e(){var t,a,n,r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.token,e.next=3,this.props.store.check_user_info(t);case 3:a=e.sent,console.log(a),a&&a.user&&(this.props.store.set_user(a.user),n=new URLSearchParams(this.props.location.search),(r=n.get("redirect"))||(r="/recharge"),this.props.history.push(r));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=I.a.createElement("div",{className:"py-5 px-5 md:px-0"},I.a.createElement("div",{className:"p-5 flex justify-center"},I.a.createElement(W.l,null)));return I.a.createElement(rt,{title:this.props.store.appname,main:e})}}]),a}(S.Component))||Me)||Me)||Me),ft=(a(1115),a(454)),bt=a(451),dt=(Re=Object(M.b)("store"),Object(F.f)(We=Re(We=Object(M.c)(We=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){var e=this,t=this.props.store[this.props.field]||"",a=this.props.options.filter((function(e){return t.includes(e.value)}));Date.now();return I.a.createElement("div",{className:"lossline "+this.props.className||!1},I.a.createElement("div",{className:"lossline"},this.props.label),I.a.createElement(bt.a,{menuPlacement:this.props.menuPosition||"auto",placeholder:this.props.placeholder||"\u8bf7\u9009\u62e9",value:a,isMulti:!1,onChange:function(t){e.props.store[e.props.field]=t?t.value:""},options:this.props.options||[]}))}}]),a}(S.Component))||We)||We)||We),vt=a(103),_t=(Le=Object(M.b)("store"),Object(F.f)(Be=Le(Be=Object(M.c)(Be=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){var e=this;return I.a.createElement(I.a.Fragment,null,I.a.createElement("div",{className:"std-hr form-div"}),I.a.createElement(W.f,null,I.a.createElement("div",{className:"flex flex-row justify-between"},I.a.createElement("div",{className:"left"},I.a.createElement(W.b,{large:"true",intent:vt.a.PRIMARY,onClick:function(){return e.props.onSubmit()}},"\u63d0\u4ea4")),I.a.createElement("div",{className:"right"},this.props.cancel||I.a.createElement(W.b,{large:"true",onClick:function(){return e.props.history.goBack()},className:"right-20"},"\u53d6\u6d88")))))}}]),a}(S.Component))||Be)||Be)||Be),gt=a(1466),Ot=a(453),jt=a(1469),yt=a(1465),kt=a(452),Et=(Ye=Object(M.b)("store"),Object(F.f)(He=Ye(He=Object(M.c)(He=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){return I.a.createElement(gt.a,{remarkPlugins:[kt.a],className:"markdown-text toastui-editor-contents",children:this.props.markdown,linkTarget:"_blank",components:{code:function(e){e.node;var t=e.inline,a=e.className,n=e.children,r=Object(H.a)(e,["node","inline","className","children"]),s=/language-(\w+)/.exec(a||"");return!t&&s?I.a.createElement(jt.a,Object.assign({children:String(n).replace(/\n$/,""),style:yt.a,language:s[1],PreTag:"div"},r)):I.a.createElement("code",Object.assign({className:a},r),n)},img:function(e){var t=e.src,a=e.alt;return I.a.createElement(Ot.a,{showDownload:!0,showRotation:!0,showZoom:!0,small:t,large:t,alt:a})}}})}}]),a}(S.Component))||He)||He)||He),xt=(Je=Object(M.b)("store"),Object(F.f)(Ue=Je(Ue=Object(M.c)(Ue=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){var e;Object(P.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={actions:{},list:[],text:"",last:!1,loading:!1,typing:"",force_cn:!1,connect:!1,show_tips:!1,in:!1,saved_list:{},settings_open:!1,avatar_open:!1,show_undo:!1},e}return Object(T.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.location.hostname.match(/ftqq.com$/)&&this.setState({in:!0}),document.addEventListener("keydown",(function(t){13===t.keyCode&&(t.metaKey||t.ctrlKey)&&e.send(e.state.text)})),document.querySelector(".chat-list").scrollTop=document.querySelector(".chat-list").scrollHeight}},{key:"onChange",value:function(e,t){this.setState(Object($e.a)({},t,e.target.value))}},{key:"save_key",value:function(){var e=Object($.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.props.store._chat_key.length<10)){e.next=3;break}return ce("\u8bf7\u8f93\u5165\u6b63\u786e\u7684OpenAPI/API2D Key"),e.abrupt("return",!1);case 3:this.props.store.save_vars(),ce("\u4fdd\u5b58\u6210\u529f");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clean_conversation",value:function(){var e=Object($.a)(V.a.mark((function e(){var t=this;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.old_list=this.state.list.slice(),this.setState({last:!1,list:[],loading:!1,show_undo:!0}),ce("\u5386\u53f2\u5bf9\u8bdd\u5df2\u6e05\u9664"),this.undo_handle||(this.undo_handle=setTimeout((function(){t.setState({show_undo:!1}),clearTimeout(t.undo_handle),t.undo_handle=null}),1e4));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"undo_conversation",value:function(){var e=Object($.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.old_list&&this.setState({last:!1,list:this.old_list,loading:!1,show_undo:!1});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"remove_list",value:function(){var e=Object($.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.props.store._chat_saved_list=this.props.store._chat_saved_list.filter((function(e){return e.name!=t})),this.props.store.save_vars();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"save_conversation",value:function(){var e=Object($.a)(V.a.mark((function e(){var t;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.state.list.length<1)){e.next=2;break}return e.abrupt("return",!1);case 2:t=this.state.list[0].text.substring(0,10)+"-"+(new Date).getTime(),this.props.store._chat_saved_list.length>100&&this.props.store._chat_saved_list.shift(),this.props.store._chat_saved_list.push({name:t,list:this.state.list}),this.props.store.save_vars();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getApiInstance",value:function(){return this.api2d_instance||(this.api2d_instance=new ft.a(this.props.store._chat_key)),this.api2d_instance}},{key:"send",value:function(){var e=Object($.a)(V.a.mark((function e(t){var a,n,r,s,c,i,o,l,u,p,h,m=this;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.props.store._chat_key.length<10)){e.next=3;break}return ce("\u8bf7\u5148\u70b9\u51fb\u53f3\u4e0a\u89d2\u6309\u94ae\u8bbe\u7f6eKey\u4ee5\u540e\u518d\u4f7f\u7528"),e.abrupt("return",!1);case 3:if(!this.state.loading){e.next=5;break}return e.abrupt("return",!1);case 5:for(a=this.state.list.concat({text:t,role:"me"}),this.setState({loading:!0,typing:"\u6b63\u5728\u601d\u8003\u4e2d...",list:a}),document.querySelector(".chat-list").scrollTop=document.querySelector(".chat-list").scrollHeight,e.prev=8,(n=this.getApiInstance()).setApiBaseUrl(this.props.store._chat_api_url),parseInt(this.props.store._chat_timeout)>0&&(n.timeout=1e3*parseInt(this.props.store._chat_timeout)),r=a.slice(-6),console.log("old",r),s=[],c=0;c<r.length;c++)"me"==r[c].role?s.push({role:"user",content:r[c].text}):s.push({role:"assistant",content:r[c].text});if(i=!0,0!=s.length){e.next=20;break}return ce("\u8bb0\u5f55\u4e3a\u7a7a"),e.abrupt("return",!1);case 20:return e.prev=20,e.next=23,n.completion({messages:s,temperature:null!==(o=parseFloat(this.props.store._chat_temperature))&&void 0!==o?o:0,max_tokens:null!==(l=parseInt(this.props.store._chat_max_tokens))&&void 0!==l?l:1e3,model:this.props.store._chat_model||"gpt-3.5-turbo",stream:i,onMessage:function(e){m.setState({typing:e}),document.querySelector(".chat-list").scrollTop=document.querySelector(".chat-list").scrollHeight},onEnd:function(e){m.setState({typing:""}),document.querySelector(".chat-list").scrollTop=document.querySelector(".chat-list").scrollHeight}});case 23:(u=e.sent)&&this.setState({list:this.state.list.concat({text:i?u.trim():null===(p=u.choices[0])||void 0===p||null===(h=p.message)||void 0===h?void 0:h.content.trim(),role:"robot"}),text:"",loading:!1}),e.next=32;break;case 27:e.prev=27,e.t0=e.catch(20),console.log("error",e.t0),ce("\u51fa\u9519\u4e86\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u548c\u8bbe\u7f6e "+e.t0.message),this.setState({loading:!1,typing:""});case 32:document.querySelector(".input-box").focus(),document.querySelector(".chat-list").scrollTop=document.querySelector(".chat-list").scrollHeight,e.next=41;break;case 36:e.prev=36,e.t1=e.catch(8),console.log("error",e.t1),ce("\u53d1\u9001\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7OpenAPI Key\u662f\u5426\u6b63\u786e\u6216\u91cd\u8bd5\u3002"),this.setState({loading:!1});case 41:case"end":return e.stop()}}),e,this,[[8,36],[20,27]])})));return function(t){return e.apply(this,arguments)}}()},{key:"select_action",value:function(){var e=Object($.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.actions[t.target.value]&&this.send(this.state.actions[t.target.value]);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"set_text",value:function(){var e=Object($.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({text:this.state.text+" "+t});case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"donate",value:function(){var e=Object($.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.props.history.push("/donate");case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"load_list",value:function(){var e=Object($.a)(V.a.mark((function e(t){var a;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=JSON.parse(t),this.setState({list:a});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object($.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.props.store._chat_key=this.props.store._chat_key.trim(),this.props.store._chat_api_url=this.props.store._chat_api_url.trim(),console.log(this.props.store._chat_key,this.props.store._chat_key.startsWith("fk")),this.props.store._chat_key.startsWith("fk")&&this.props.store._chat_api_url.startsWith("https://api.openai.com")&&(this.props.store._chat_api_url="https://openai.api2d.net",ce("\u68c0\u6d4b\u5230\u60a8\u4f7f\u7528\u7684\u662fForward Key\uff0c\u5df2\u81ea\u52a8\u5207\u6362\u5230api2d.net")),this.props.store.save_vars(),this.setState({settings_open:!1});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avatar_save",value:function(){var e=Object($.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.props.store.save_vars(),this.setState({avatar_open:!1});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"abort",value:function(){var e=Object($.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.getApiInstance().abort(),this.setState({loading:!1,typing:""});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,a=this,n=I.a.createElement("div",{className:"right-box"},I.a.createElement("div",{className:"row flex md:flex-row flex-col"},I.a.createElement("div",{className:"left flex-1"}),I.a.createElement("div",{className:"right"},I.a.createElement(W.d,{vertical:window.innerWidth<600},I.a.createElement(W.b,{icon:"key",onClick:function(){return a.setState({settings_open:!0})},large:!0},"Key\u548c\u6a21\u578b\u8bbe\u7f6e"),I.a.createElement(W.b,{icon:"info-sign",onClick:function(){return ce("\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528")},large:!0},"\u6570\u636e\u5b89\u5168")))),I.a.createElement("div",{className:"chat-list"},this.state.list&&this.state.list.map((function(e,t){var n;return I.a.createElement("div",{className:"chat-item ".concat(e.role),key:t},I.a.createElement("div",{className:"chat-text content ",onDoubleClick:function(){return a.set_text(e.text)}},I.a.createElement(Et,{markdown:null===(n=e.text)||void 0===n?void 0:n.trim()})))})),this.state.typing&&I.a.createElement("div",{className:"chat-item robot"},I.a.createElement("div",{className:"chat-text content"},I.a.createElement(W.l,{size:12,className:"mr-2"}),null===(e=this.state.typing)||void 0===e?void 0:e.trim()," ",I.a.createElement(W.b,{icon:"cross",minimal:!0,onClick:function(){return a.abort()}})))),I.a.createElement("div",{className:"chat-box"},I.a.createElement("form",{action:"post",id:"chat-form",className:"flex flex-col",onSubmit:function(e){e.preventDefault(),a.send(a.state.text)}},I.a.createElement(W.m,{large:!0,rows:4,disabled:this.state.loading,placeholder:"\u8f93\u5165\u4f60\u7684\u95ee\u9898",autoFocus:!0,className:"input-box",onChange:function(e){return a.onChange(e,"text")},value:this.state.text}),I.a.createElement("div",{className:"flex md:flex-row md:justify-between flex-col items-center mb-2"},I.a.createElement("div",{className:"left flex md:flex-row md:items-center flex-col"},I.a.createElement(dt,{className:"mt-2 mb-2 md:mb-0 md:block hidden",field:"_chat_model",options:[{label:"GPT3.5",value:"gpt-3.5-turbo"},{label:"GPT4",value:"gpt-4"}]}),I.a.createElement(W.c,{className:"mt-2 md:mt-0"},I.a.createElement(W.b,{large:!0,className:"md:mt-2 md:ml-1",icon:this.state.loading?I.a.createElement(W.l,{size:12}):"send-message",type:"submit",disabled:this.state.loading},this.state.loading?"\u8bf7\u7a0d\u5019":"\u53d1\u9001(cmd/ctrl+enter)"),this.state.show_undo?I.a.createElement(W.b,{large:!0,className:"md:mt-2 ",icon:"undo",onClick:function(){return a.undo_conversation()}},"\u6062\u590d"):I.a.createElement(W.b,{large:!0,className:"md:mt-2 ",icon:"clean",onClick:function(){return a.clean_conversation()}},"\u65b0\u5bf9\u8bdd"))),I.a.createElement("div",{className:"right hidden md:block"},I.a.createElement(W.b,{large:!0,className:"mt-2 ml-2",icon:"floppy-disk",onClick:function(){return a.save_conversation()}},"\u4fdd\u5b58\u5bf9\u8bdd"))))));(this.state.actions?Object.keys(this.state.actions).map((function(e){if(e.trim().length>0)return{label:e,value:e}})):[]).unshift({label:"\u8bf7\u9009\u62e9",value:""});var r=I.a.createElement("div",{className:"left-box flex-1"},I.a.createElement("div",null,this.props.store._chat_saved_list&&this.props.store._chat_saved_list.length>0&&I.a.createElement("div",{className:"text-lg mb-2 text-gray-300 text-right mt-6 mr-2"},"\u5386\u53f2\u8bb0\u5f55"),I.a.createElement("div",{className:"history-list"},this.props.store._chat_saved_list&&(null===(t=this.props.store._chat_saved_list)||void 0===t?void 0:t.reverse().map((function(e,t){return I.a.createElement("div",{key:t,className:"mb-2 border rounded mb-2 p-2 text-sm text-gray-400 hover:text-blue-400 flex flex-row justify-between"},I.a.createElement("div",{className:"left flex flex-row items-center"},e.name.substring(0,12)),I.a.createElement("div",{className:"right ml-2 gray-btn"},I.a.createElement(W.b,{small:!0,minimal:!0,icon:"reset",title:"\u8f7d\u5165",onClick:function(){return a.load_list(JSON.stringify(e.list))}}),I.a.createElement(W.b,{small:!0,minimal:!0,icon:"cross",title:"\u5220\u9664",onClick:function(){return a.remove_list(e.name)}})))}))))),I.a.createElement("img",{src:this.props.store._chat_avatar_url||"char.png",onError:function(){a.props.store._chat_avatar_url&&(a.props.store._chat_avatar_url=null)},alt:"\u770b\u677f\u5a18\u7531charat.me\u751f\u6210",className:"char",onClick:function(){return a.setState({avatar_open:!0})}})),s=I.a.createElement("div",{className:"flex flex-row chat-page"},r,n,this.state.show_tips&&I.a.createElement(W.e,{className:"p-10",isOpen:this.state.show_tips,onClose:function(){return a.setState({show_tips:!1})}},I.a.createElement("div",{className:"bg-white p-5 rounded mb-3"},"\ud83c\udf89 Chat\u9171\u652f\u6301\u4e86Forward KEY\uff0c\u53ef\u4ee5\u7528\u56fd\u5185\u5361\u5145\u503c\u4e86"),I.a.createElement("div",{className:"text-lg"},"\u7533\u8bf7Forward KEY\xb7\u56fd\u5185\u5361\u53ef\u7528"),I.a.createElement("ul",{className:"lead-loose pt-2"},I.a.createElement("li",{className:"mb-1"},"\u2460 \u7528GitHub\u8d26\u53f7\u767b\u5165",I.a.createElement("a",{href:"https://api2d.com",target:"_blank"},"API2D")),I.a.createElement("li",{className:"mb-1"},"\u2461 \ud83d\udcb0\u5230",I.a.createElement("a",{href:"https://api2d.com/wechat/recharge",target:"_blank"},"\u5145\u503c\u9875\u9762\u5145\u503c")),I.a.createElement("li",{className:"mb-1"},"\u2462 \u5c06Forward KEY\u586b\u5165\u672c\u9875\u9762\u5373\u53ef")),this.state.in?I.a.createElement("div",{className:"text-gray-400 mt-5"},"\u26a0\ufe0f \u5f53\u524d\u73af\u5883\u65e0\u6cd5\u4f7f\u7528OpenAI API"):I.a.createElement(I.a.Fragment,null,I.a.createElement("div",{className:"text-lg mt-5"},"\u7533\u8bf7 OpenAI \u5b98\u65b9 KEY"),I.a.createElement("ul",{className:"lead-loose pt-2"},I.a.createElement("li",{className:"mb-1"},"\u2460 \u4f7f\u7528\u6d77\u5916\u7f51\u7edc\u8bbf\u95ee",I.a.createElement("a",{href:"https://openai.com/api/",target:"_blank"},"OpenAI")),I.a.createElement("li",{className:"mb-1"},"\u2461 \ud83d\udcb0",I.a.createElement("a",{href:"https://sms-activate.org/?ref=4207095",target:"_blank"},"\u6ce8\u518c\u6d77\u5916\u865a\u62df\u7535\u8bdd\u53f7\u7801\u63a5\u6536\u6fc0\u6d3b\u77ed\u4fe1")),I.a.createElement("li",{className:"mb-1"},"\u2462 ",I.a.createElement("a",{href:"https://openai.com/api/",target:"_blank"},"\u5230API\u9875\u9762\u521b\u5efa\u5e76\u590d\u5236KEY")),I.a.createElement("li",{className:"mb-1 text-gray-400"},"PS: OpenAI\u8d26\u53f7\u4e0d\u63a5\u53d7\u56fd\u5185\u4fe1\u7528\u5361\u5145\u503c\uff0c\u56e0\u6b64\u7528\u5b8c\u514d\u8d39\u989d\u5ea6\u540e\u53ea\u80fd\u91cd\u65b0\u6ce8\u518c")))),I.a.createElement(W.e,{isOpen:this.state.settings_open,title:"Key\u548c\u6a21\u578b\u53c2\u6570\u8bbe\u7f6e",icon:"info-sign",onClose:function(){return a.setState({settings_open:!1})}},I.a.createElement("div",{className:"p-5 mt-2"},I.a.createElement(ct,{field:"_chat_key",label:"KEY",placeholder:"\u8bf7\u8f93\u5165OpenAI/Forward KEY: sk-xxx/fkxxx"}),I.a.createElement(ct,{field:"_chat_api_url",label:"API\u5730\u5740",placeholder:"\u8bf7\u8f93\u5165API\u5730\u5740\uff0c\u7559\u7a7a\u8bbf\u95eeOpenAI\u5b98\u65b9"}),I.a.createElement(ct,{field:"_chat_max_tokens",label:"Max Tokens",placeholder:"\u6700\u5927 token \u6570\u91cf\uff0c\u4e00\u822c\u804a\u59291000\u5373\u53ef\uff0c3.5\u6700\u5927\u4e3a4000,4\u4e3a8000\uff0c\u5426\u5219\u5bb9\u6613\u51fa\u9519"}),I.a.createElement(ct,{field:"_chat_temperature",label:"Temperature",placeholder:"\u53d1\u6563\u7a0b\u5ea6\uff0c0~2\u4e4b\u95f4\uff0c\u8d8a\u5927\u8d8a\u53d1\u6563"}),I.a.createElement(ct,{field:"_chat_timeout",label:"\u8d85\u65f6\u65f6\u95f4\xb7\u79d2",placeholder:"\u8d85\u65f6\u4f1a\u81ea\u52a8\u7ec8\u6b62\u8bf7\u6c42"}),I.a.createElement(_t,{onSubmit:function(){return a.save()},cancel:I.a.createElement(W.a,{large:!0,icon:"key",href:"https://api2d.com/r/186008",target:"_blank"},"\u7533\u8bf7Forward Key \xb7 \u53ef\u5fae\u4fe1\u5145\u503c")}))),I.a.createElement(W.e,{isOpen:this.state.avatar_open,title:"\u8bbe\u7f6e\u804a\u5929\u52a9\u7406",icon:"info-sign",onClose:function(){return a.setState({avatar_open:!1})}},I.a.createElement("div",{className:"p-5 mt-2"},I.a.createElement(ct,{field:"_chat_avatar_url",placeholder:"\u8bf7\u7c98\u8d34\u4e00\u4e2a\u53ef\u4ee5\u8bbf\u95ee\u7684\u56fe\u7247URL\uff0c\u6700\u597d\u80cc\u666f\u900f\u660e"}),I.a.createElement(_t,{onSubmit:function(){return a.avatar_save()},cancel:I.a.createElement(W.b,{onClick:function(){return a.setState({avatar_open:!1})},large:!0},"\u5173\u95ed")}))));return I.a.createElement(rt,{title:this.props.store.appname,main:s})}}]),a}(S.Component))||Ue)||Ue)||Ue),wt=a(450),Nt=(Ge=Object(M.b)("store"),Object(F.f)(Ve=Ge(Ve=Object(M.c)(Ve=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"submit",value:function(){var e=Object($.a)(V.a.mark((function e(){var t,a,n,r,s,c;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.store._donate_keys.trim().split("\n"),a=[],ce("\u6b63\u5728\u9a8c\u8bc1KEY\uff0c\u8bf7\u7a0d\u5019"),n=Object(wt.a)(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=14;break}return s=r.value,e.next=10,this.props.store.api.rawPost("".concat(this.props.store.local_apibase,"/chat/verify"),{key:s});case 10:(c=e.sent)&&"done"==c.message&&a.push(s);case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),n.e(e.t0);case 19:return e.prev=19,n.f(),e.finish(19);case 22:if(!(a.length<1)){e.next=27;break}return ce("\u6ca1\u6709\u662f\u6709\u6548\u7684KEY"),e.abrupt("return");case 27:ce("".concat(a.length,"\u4e2aKEY\u901a\u8fc7\u6821\u9a8c\uff0c\u6b63\u5728\u63d0\u4ea4\u6570\u636e"));case 28:case"end":return e.stop()}}),e,this,[[4,16,19,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=I.a.createElement("div",{className:"p-12"},I.a.createElement("div",{className:"text-center text-2xl"},"\u8d5e\u52a9OpenAI KEY"),I.a.createElement(ct,{type:"textarea",fill:!0,label:"OpenAI KEY",field:"_donate_keys",placeholder:"\u4e00\u884c\u4e00\u4e2aKey\uff0c\u5f62\u5982 sk... "}),I.a.createElement(ct,{label:"\u6587\u5b57\u5e7f\u544a\u6587\u6848",field:"_donate_title",placeholder:"30\u5b57\u7b26\u5185\uff0c\u4f1a\u4eba\u5de5\u5ba1\u6838\uff0c\u8fdd\u53cd\u5185\u5730\u6cd5\u5f8b\u6cd5\u89c4\u548c\u4e0d\u771f\u5b9e\u5185\u5bb9\u5c06\u4e0d\u4f1a\u901a\u8fc7"}),I.a.createElement(ct,{label:"\u6587\u5b57\u5e7f\u544a\u94fe\u63a5",field:"_donate_link",placeholder:"https://... \u53ef\u586b\u5165\u4e2a\u4eba\u7f51\u7ad9\u3001\u7f51\u5e97\u3001\u535a\u5ba2\u4e4b\u7c7b"}),I.a.createElement(_t,{label:"\u63d0\u4ea4",onSubmit:function(){return e.submit()}}),I.a.createElement("div",{className:"text-lg mt-8"},"\u6548\u679c\u9884\u89c8"),I.a.createElement("div",{className:"preview border rounded p-5 mt-5"},I.a.createElement("div",{className:"line-1"},"\u60a8\u4f7f\u7528\u7684 Key \u7531 ",I.a.createElement("span",{className:"text-blue-500"},this.props.store.user.name)," \u53cb\u60c5\u63d0\u4f9b"),I.a.createElement("div",{className:"line-2 mt-3 flex flex-row item-center"},I.a.createElement("span",{className:"text-white bg-gray-300 rounded px-1 mr-2"},"\u5e7f\u544a"),I.a.createElement("a",{href:this.props.store._donate_link||"https://stack.ftqq.com/subscribe",target:"_blank"},this.props.store._donate_title||"\u65b9\u7cd6\u8d85\u7ea7\u4f1a\u5458\xb7\u52a9\u529b\u4ece\u87ba\u4e1d\u9489\u5230\u4e00\u4eba\u4f01\u4e1a"))));return I.a.createElement(rt,{title:this.props.store.appname,main:t})}}]),a}(S.Component))||Ve)||Ve)||Ve),Ct=function(e){Object(K.a)(a,e);var t=Object(z.a)(a);function a(){return Object(P.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){return I.a.createElement(D.a,null,I.a.createElement(F.c,null,I.a.createElement(F.a,{path:"/donate",component:Nt}),I.a.createElement(F.a,{path:"/chat",component:xt}),I.a.createElement(F.a,{path:"/login/auto/:token",component:mt}),I.a.createElement(F.a,{path:"/after/login",component:ht}),I.a.createElement(F.a,{path:"/profile",component:ut}),I.a.createElement(F.a,{path:"/recharge",component:ot}),I.a.createElement(F.a,{path:"/logout",component:lt}),I.a.createElement(F.a,{path:"/logback",component:st}),I.a.createElement(F.a,{path:"/login",component:pt}),I.a.createElement(F.a,{path:"/index",component:L}),I.a.createElement(F.a,{path:"/",component:xt})))}}]),a}(S.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));console.log("Welcome to ".concat(ne.appname)),console.log=function(){},A.a.render(I.a.createElement(M.a,{store:ne},I.a.createElement(Ct,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},572:function(e,t,a){e.exports=a(1431)},577:function(e,t,a){}},[[572,1,2]]]);